---
// src/components/Header.astro
import { Icon } from 'astro-icon/components';
---
<header class="bg-accent text-white">
    <div class="container mx-auto flex items-center justify-between p-4">
        <!-- Site Logo -->
        <a href="/" class="text-2xl font-bold tracking-wider">
            USRARAMA
        </a>

        <!-- Desktop Navigation -->
        <nav class="hidden md:block">
            <ul class="flex gap-6 font-semibold">
                <li>
                    <a href="/projects" class="uppercase hover:underline">Projects</a>
                </li>
                <li>
                    <a href="/about" class="uppercase hover:underline">About</a>
                </li>
            </ul>
        </nav>

        <!-- Mobile Menu Button -->
        <button id="menu-btn" class="z-50 md:hidden">
            <Icon name="fa-solid:bars" class="h-6 w-6" id="menu-open-icon" />
            <Icon name="fa-solid:times" class="hidden h-6 w-6" id="menu-close-icon" />
        </button>
    </div>

    <!-- Mobile Menu Overlay -->
    <div
        id="mobile-menu"
        class="hidden fixed inset-0 z-40 flex flex-col items-center justify-center bg-primary/90 bg-black/20 backdrop-blur-lg"
    >
        <nav>
            <ul class="flex flex-col gap-8 text-center text-2xl font-bold text-white">
                <li>
                    <a href="/projects" class="uppercase hover:underline">Projects</a>
                </li>
                <li>
                    <a href="/about" class="uppercase hover:underline">About</a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<script>
    /**
     * Toggles the mobile menu.
     * This script is designed to run on initial page load and after each
     * Astro View Transition. A 'data-listener-attached' attribute is used
     * to prevent attaching multiple click event listeners to the same button.
     */
    const initMobileMenu = () => {
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const openIcon = document.getElementById('menu-open-icon');
        const closeIcon = document.getElementById('menu-close-icon');

        if (!menuBtn || !mobileMenu || !openIcon || !closeIcon) {
            return;
        }

        if (menuBtn.dataset.listenerAttached === 'true') {
            return;
        }

        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            openIcon.classList.toggle('hidden');
            closeIcon.classList.toggle('hidden');
            document.body.classList.toggle('overflow-hidden');
        });

        menuBtn.dataset.listenerAttached = 'true';
    };

    // Handles the very first load of the page
    document.addEventListener('DOMContentLoaded', initMobileMenu);

    // Handles every subsequent navigation with View Transitions
    document.addEventListener('astro:page-load', initMobileMenu);
</script>